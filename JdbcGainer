package model;

import java.sql.*;
import java.util.ArrayList;
import java.util.Map;
import java.util.HashMap;
public class JdbcGainer implements Jdbc
{
	Connection myconn=null;
	Statement  st=null;
	ArrayList<Object> performTable1=new ArrayList<Object>();
	int i=0;
	
	public ArrayList<Object> view()
	{
		
	  try
	  {
	       Class.forName("oracle.jdbc.driver.OracleDriver");
	       myconn=DriverManager.getConnection(oraURL,uid,pwd);
	       String query = "Select COMPANY_NAME,TICKER, CURRENT_PRICE - LAST_CLOSED_PRICE, ((CURRENT_PRICE - LAST_CLOSED_PRICE)/LAST_CLOSED_PRICE)*100 from company_details_table11 WHERE ROWNUM <=5 ORDER BY CURRENT_PRICE - LAST_CLOSED_PRICE";
	       
	       st = myconn.createStatement();
	       ResultSet rs = st.executeQuery(query);
	       
	       while(rs.next())
	       {  
	    	   Map<String,String> val = new HashMap<String,String>();
	    	   
	    	   String cmp=rs.getString(1);
	    	   String tkr=rs.getString(2);
	    	   String diff=rs.getString(3)+"";
	    	   String perc=rs.getString(4)+"";
	    	   
	    	   
	    	   
	    	     val.put("cmp",cmp);
	    	     val.put("tkr",tkr);
	    	     val.put("diff",diff);
	    	     val.put("perc",perc);
	    	     
	    	     
	    	    
	    	     
	    	     performTable1.add(i,val);
	    	     i++;
	    	    
	       }
	       
	    	   
	    	   
	    	   
	    	   
	    	     
	    	    
	       

	       
	     rs.close();
	     
         st.close();
         myconn.close();
         
	  }
     catch(SQLException se)
     {
      se.printStackTrace();
     }
     catch(Exception e)
     {
      e.printStackTrace();
     }
     finally
     {
       try{
        if(st!=null)
           st.close();
         }
       catch(SQLException se2)
         {
    	   
         } 
       try{
        if(myconn!=null)
           myconn.close();
          }
       catch(SQLException se)
          {
        se.printStackTrace();
          }
      }
	  return performTable1;
	 
  }
	
	
}
